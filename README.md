# Прогноз покупки в течение 90 дней (Marketing)

## Описание
Проект решает задачу бинарной классификации: предсказать вероятность покупки пользователем в течение 90 дней.
Используются данные о покупках и взаимодействиях с маркетинговыми рассылками.

Ключевая особенность задачи — сильный дисбаланс классов (покупки < 2% клиентов), поэтому качество оценивается через ROC-AUC, а порог классификации подбирается под бизнес-цель по Precision–Recall.

## Данные
Используются 3 файла:
- `apparel-purchases.csv` — история покупок
- `apparel-messages.csv` — события рассылок (open/click)
- `apparel-target_binary.csv` — целевая переменная (покупка в течение 90 дней)

> Примечание: если данные нельзя публиковать, оставь в репо только структуру и описание, а сами CSV добавь в `.gitignore`.

## Основные шаги
1. Загрузка и первичный анализ данных
2. Предобработка: удаление дубликатов, приведение типов, агрегация покупок
3. Feature engineering:
   - признаки по покупкам: `avg_price`, `total_spent`, `total_quantity`, `sale_ratio`, `avg_categories`
   - признаки по рассылкам: `opens_count`, `clicks_count`, `total_events`, `click_to_open_ratio`
4. Обучение моделей и подбор гиперпараметров (RandomizedSearchCV, StratifiedKFold)
5. Сравнение стратегий дисбаланса:
   - без ресемплинга (лучше)
   - SMOTE внутри CV (хуже по ROC-AUC)
6. Финальная модель: `XGBClassifier`
7. Подбор порога под бизнес-цель через Precision–Recall (OOF-предсказания без утечки)

## Результаты
- Лучший ROC-AUC на кросс-валидации: ~0.702
- ROC-AUC на тесте: ~0.712 (требование ≥ 0.70 выполнено)

### Порог под бизнес-сценарии
**Вариант 1: экономим рассылку (precision ≥ 0.10, max recall)**
- threshold ≈ 0.0863
- Test: precision ≈ 0.087, recall ≈ 0.046

**Вариант 2: ловим максимум покупателей (recall ≥ 0.30, max precision)**
- threshold ≈ 0.0356
- Test: precision ≈ 0.060, recall ≈ 0.338

## Как запустить
1) Установить зависимости: 
```bash
pip install -r requirements.txt
